((e,t)=>{"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).exportFromJSON=t()})(this,function(){function j(e){return"[object Array]"===Object.prototype.toString.call(e)}function g(e,t){if(!e)throw new Error(t)}function O(e){return Object.keys(e)}function R(t){return Object.keys(t).map(function(e){return[e,t[e]]})}function U(e,t,n){var r="."+t,t=new RegExp("(\\".concat(t,")?$"));return n(e).replace(t,r)}function a(e){return e.replace(/[^_a-zA-Z 0-9:\-\.]/g,"").replace(/^([ 0-9-:\-\.]|(xml))+/i,"").replace(/ +/g,"-")}function u(e){return Array(e+1).join(" ")}function i(e){console.log(e);e=e.replace(/([<>&])/g,function(e,t){switch(t){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;";default:return""}});return console.log(e),e}function E(e,t,n,r){void 0===n&&(n="download");e=((e,t,n)=>{switch(t){case"txt":var r="text/plain;charset=utf-8";return n?URL.createObjectURL(new Blob([e],{type:r})):"data:,".concat(r)+encodeURIComponent(e);case"css":r="text/css;charset=utf-8";return n?URL.createObjectURL(new Blob([e],{type:r})):"data:,".concat(r)+encodeURIComponent(e);case"html":r="text/html;charset=utf-8";return n?URL.createObjectURL(new Blob([e],{type:r})):"data:,".concat(r)+encodeURIComponent(e);case"json":r="text/json;charset=utf-8";return n?URL.createObjectURL(new Blob([e],{type:r})):"data:,".concat(r)+encodeURIComponent(e);case"csv":r="text/csv;charset=utf-8";return n?URL.createObjectURL(new Blob([e],{type:r})):"data:,".concat(r)+encodeURIComponent(e);case"xls":r="text/application/vnd.ms-excel;charset=utf-8";return n?URL.createObjectURL(new Blob([e],{type:r})):"data:,".concat(r)+encodeURIComponent(e);case"xml":r="text/application/xml;charset=utf-8";return n?URL.createObjectURL(new Blob([e],{type:r})):"data:,".concat(r)+encodeURIComponent(e);default:return""}})(e,t,r=void 0===r?!0:r),t=document.createElement("a");t.href=e,t.download=n,t.setAttribute("style","visibility:hidden"),document.body.appendChild(t),t.dispatchEvent(new MouseEvent("click",{bubbles:!1,cancelable:!1,view:window})),document.body.removeChild(t)}var L=function(){return(L=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function C(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,c=n.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(r=c.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=c.return)&&n.call(c)}finally{if(o)throw o.error}}return a}function o(c){return c.map(R).reduce(function(e,t,o){return t.reduce(function(e,t){var t=C(t,2),n=t[0],t=t[1],r=e[n]||Array.from({length:c.length}).map(function(e){return""});return r[o]=("string"!=typeof t?JSON.stringify(t):t)||"",e[n]=r,e},e)},Object.create(null))}function c(e,t){return(t=void 0===t?function(e){return e}:t)(R(e).map(function(e){e=C(e,2);return{fieldName:e[0],fieldValues:e[1]}}))}var l={beforeTableEncode:function(e){return e},delimiter:","};function T(e,t){void 0===t&&(t={});var t=L(L({},l),t),n=t.beforeTableEncode,r=t.delimiter;return e.length?(t=c(o(e),n)).map(function(e){return e.fieldName}).join(r)+"\r\n"+t.map(function(e){return e.fieldValues}).map(function(e){return e.map(function(e){return e=e,t=r,t=new RegExp("".concat(t,'|"|\n')).test(e)?'"':"",e=e.replace(/"/g,'""'),"".concat(t).concat(e).concat(t);var t})}).reduce(function(e,n){return e.map(function(e,t){return"".concat(e).concat(r).concat(n[t])})}).join("\r\n"):""}var n={beforeTableEncode:function(e){return e}};function N(e,t){var t=L(L({},n),t).beforeTableEncode;return e.length?'<html>\n  <head>\n    <meta charset="UTF-8" />\n  </head >\n  <body>\n    '.concat((t=t,g(0<(e=e).length),e=c(o(e),t),t=e.map(function(e){return e.fieldName}).join("</b></th><th><b>"),e=e.map(function(e){return e.fieldValues}).map(function(e){return e.map(function(e){return"<td>".concat(e,"</td>")})}).reduce(function(e,n){return e.map(function(e,t){return"".concat(e).concat(n[t])})}),"\n    <table>\n      <thead>\n        <tr><th><b>".concat(t,"</b></th></tr>\n      </thead>\n      <tbody>\n        <tr>").concat(e.join("</tr>\n        <tr>"),"</tr>\n      </tbody>\n    </table>\n  ")),"\n  </body>\n</html >\n"):""}function I(e,t){return'<?xml version="1.0" encoding="utf-8"?><!DOCTYPE base>\n'.concat(function n(e,t,r,o){void 0===r&&(r="row");void 0===o&&(o=0);t=a(t);var c=u(o);if(null==e)return"".concat(c,"<").concat(t," />");e=j(e)?e.map(function(e){return n(e,r,r,o+2)}).join("\n"):"object"==typeof e?R(e).map(function(e){var e=C(e,2),t=e[0],e=e[1];return n(e,t,r,o+2)}).join("\n"):i(String(e));c="".concat(c,"<").concat(t,">").concat(e,"</").concat(t,">");return c}(e,t=void 0===t?"base":t),"\n")}function e(e){var t=e.data,n=e.fileName,r=void 0===n?"download":n,o=e.extension,n=e.fileNameFormatter,c=void 0===n?function(e){return e.replace(/\s+/,"_")}:n,n=e.fields,a=e.exportType,u=void 0===a?"txt":a,a=e.replacer,a=void 0===a?null:a,i=e.space,i=void 0===i?4:i,l=e.processor,d=void 0===l?E:l,l=e.withBOM,f=void 0!==l&&l,l=e.beforeTableEncode,s=void 0===l?function(e){return e}:l,l=e.delimiter,p=void 0===l?",":l,b="Invalid export data. Please provide an array of objects",m="Can't export unknown data type ".concat(u,"."),v="Can't export string data to ".concat(u,".");if("string"==typeof t)switch(u){case"txt":case"css":case"html":return d(t,u,U(r,null!=o?o:u,c));default:throw new Error(v)}var h,y=(!(e=n)||j(e)&&!e.length||!j(e)&&!O(e).length?function(e){return e}:(h=j(e)?e.reduce(function(e,t){return L(L({},e),((e={})[t]=t,e))},Object.create(null)):e,function(e){return j(e)?e.map(function(e){return R(e).reduce(function(e,t){var t=C(t,2),n=t[0],t=t[1];return n in h&&(e[h[n]]=t),e},Object.create(null))}).filter(function(e){return O(e).length}):R(e).reduce(function(e,t){var t=C(t,2),n=t[0],t=t[1];return n in h&&(e[h[n]]=t),e},Object.create(null))}))((e=>{try{return"string"==typeof e?JSON.parse(e):e}catch(e){throw new Error("Invalid export data. Please provide a valid JSON")}})(t)),x=((e,t,n)=>{void 0===t&&(t=null);try{return JSON.stringify(e,t,n)}catch(e){throw new Error("Invalid export data. Please provide valid JSON object")}})(y,a,i);switch(u){case"txt":case"css":case"html":return d(x,u,U(r,null!=o?o:u,c));case"json":return d(x,u,U(r,null!=o?o:"json",c));case"csv":g(j(y),b);var w=T(y,{beforeTableEncode:s,delimiter:p});return d(f?"\ufeff"+w:w,u,U(r,null!=o?o:"csv",c));case"xls":return g(j(y),b),d(N(y,{beforeTableEncode:s}),u,U(r,null!=o?o:"xls",c));case"xml":return d(I(y,r),u,U(r,null!=o?o:"xml",c));default:throw new Error(m)}}return e.types={txt:"txt",css:"css",html:"html",json:"json",csv:"csv",xls:"xls",xml:"xml"},e.processors={downloadFile:E},e});
